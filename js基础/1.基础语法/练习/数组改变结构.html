<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        // let arr1 = [
        //     {
        //         year: "2022",
        //         list : [
        //             {time: "20220212",data: "sdsadasd"},
        //             {time: "20220212",data: "sdsadasd"},
        //             {time: "20220212",data: "sdsadasd"},
        //         ]
        //     },
        //     {
        //         year: "2021",
        //         list : [
        //             {time: "20210212",data: "dddddd"},
        //             {time: "20210212",data: "dddddd"},
        //             {time: "20210212",data: "dddddd"},
        //         ]
        //     }
        // ]

        // 将arr改变为上面结构
        // 思路
        // 1.将数组按照年份分割成几个小数组
        // 2.把数组变为对象
        // 3.再给此对象添加一个年份的属性



        let arr = [
            {time: "20220212",val: "sdsadasd"},
            {time: "20220212",val: "sdsadasd"},
            {time: "20220212",val: "sdsadasd"},
            {time: "20210212",val: "dddddd"},
            {time: "20210212",val: "dddddd"},
            {time: "20210212",val: "dddddd"},
            {time: "20110212",val: "sss"},
            {time: "20110212",val: "sss"},
            {time: "20110212",val: "sss"},
            {time: "20110212",val: "sss"},
        ]
        
        // 获取年份并做去重（没用到此数组去做分割，纯小丑）
        // arr.forEach(item=>{
        //     let yearnum = item.time.slice(0,4)
        //     year.push(yearnum)
        // })
        // // 
        // let uniyear = [...new Set(year)] 

        //根据年份拆分数组
        let dataArr = []
        arr.map(mapItem => {
            if (dataArr.length == 0) {
                dataArr.push({
                    YearTime: mapItem.time.slice(0,4),
                    data: [mapItem]
                })
            } else {
                let res = dataArr.some(item => { //判断相同年份，有就添加到当前项
                    if (item.YearTime == mapItem.time.slice(0,4)) {
                        item.data.push(mapItem)
                        return
                    }
                })
                if (!res) { //如果没找相同年份添加一个新对象
                    dataArr.push({
                        YearTime: mapItem.time.slice(0,4),
                        data: [mapItem]
                    })
                }
            }
        })
        console.log(dataArr)


    </script>
</body>
</html>